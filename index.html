<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì°½í˜„ì´ì—ê²Œ í•˜ê³ ì‹¶ì€ë§</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Auth Modal -->
    <div id="authModal" class="auth-modal" style="display: none;">
        <div class="auth-modal-content">
            <button class="auth-close-btn" id="closeAuthModal">&times;</button>
            <div class="auth-tabs">
                <button class="auth-tab active" data-tab="login">ë¡œê·¸ì¸</button>
                <button class="auth-tab" data-tab="signup">íšŒì›ê°€ì…</button>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="auth-form active">
                <h2>ë¡œê·¸ì¸</h2>
                <form id="loginFormElement">
                    <div class="auth-form-group">
                        <label for="loginEmail">ì´ë©”ì¼</label>
                        <input type="email" id="loginEmail" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="loginPassword">ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                    <button type="submit" class="auth-submit-btn">ë¡œê·¸ì¸</button>
                </form>
                <div id="loginError" class="auth-error"></div>
            </div>
            
            <!-- Signup Form -->
            <div id="signupForm" class="auth-form">
                <h2>íšŒì›ê°€ì…</h2>
                <form id="signupFormElement">
                    <div class="auth-form-group">
                        <label for="signupName">ì´ë¦„</label>
                        <input type="text" id="signupName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="signupEmail">ì´ë©”ì¼</label>
                        <input type="email" id="signupEmail" placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                    <div class="auth-form-group">
                        <label for="signupPassword">ë¹„ë°€ë²ˆí˜¸</label>
                        <input type="password" id="signupPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ìµœì†Œ 6ì)" required minlength="6">
                    </div>
                    <div class="auth-form-group">
                        <label for="signupPasswordConfirm">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                        <input type="password" id="signupPasswordConfirm" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" required>
                    </div>
                    <button type="submit" class="auth-submit-btn">íšŒì›ê°€ì…</button>
                </form>
                <div id="signupError" class="auth-error"></div>
            </div>
        </div>
    </div>

    <!-- User Info -->
    <div class="user-info-bar">
        <div class="user-info-content">
            <span id="userDisplayName" class="user-name"></span>
            <button id="logoutBtn" class="logout-btn" style="display: none;">ë¡œê·¸ì•„ì›ƒ</button>
            <div class="auth-buttons" id="authButtons" style="display: flex; gap: 0.5rem;">
                <button id="loginBtn" class="login-btn">ë¡œê·¸ì¸</button>
                <button id="signupBtn" class="signup-btn">íšŒì›ê°€ì…</button>
            </div>
            <button id="adminBtn" class="admin-btn" style="display: none;">ê´€ë¦¬ì</button>
            <button id="createFirstAdminBtn" class="create-admin-btn" style="display: none;">ì²« ê´€ë¦¬ì ìƒì„±</button>
        </div>
    </div>

    <!-- First Admin Modal -->
    <div id="firstAdminModal" class="auth-modal" style="display: none;">
        <div class="auth-modal-content">
            <button class="auth-close-btn" id="closeFirstAdminModal">&times;</button>
            <h2 style="margin-bottom: 1.5rem;">ì²« ê´€ë¦¬ì ìƒì„±</h2>
            <p style="margin-bottom: 1.5rem; color: var(--text-gray);">ì‹œìŠ¤í…œì— ê´€ë¦¬ìê°€ ì—†ìŠµë‹ˆë‹¤. ì²« ê´€ë¦¬ì ê³„ì •ì„ ìƒì„±í•´ì£¼ì„¸ìš”.</p>
            <form id="firstAdminForm">
                <div class="auth-form-group">
                    <label for="firstAdminEmail">ê´€ë¦¬ì ì´ë©”ì¼</label>
                    <input type="email" id="firstAdminEmail" placeholder="ê´€ë¦¬ì ì´ë©”ì¼" required>
                </div>
                <div class="auth-form-group">
                    <label for="firstAdminPassword">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" id="firstAdminPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ (ìµœì†Œ 6ì)" required minlength="6">
                </div>
                <div class="auth-form-group">
                    <label for="firstAdminPasswordConfirm">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                    <input type="password" id="firstAdminPasswordConfirm" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ ì…ë ¥í•˜ì„¸ìš”" required>
                </div>
                <button type="submit" class="auth-submit-btn">ê´€ë¦¬ì ìƒì„±</button>
            </form>
            <div id="firstAdminError" class="auth-error" style="display: none;"></div>
        </div>
    </div>

    <div class="container">
        <!-- Hero Section -->
        <section class="hero-section">
            <div class="hero-content">
                <div class="hero-icon">ğŸ’¬</div>
                <h1 class="hero-title">ì°½í˜„ì´ì—ê²Œ</h1>
                <h2 class="hero-subtitle">í•˜ê³ ì‹¶ì€ë§</h2>
                <p class="hero-description">í•˜ê³  ì‹¶ì€ ë§ì„ ììœ ë¡­ê²Œ ë‚¨ê²¨ì£¼ì„¸ìš”</p>
            </div>
        </section>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Guestbook Form Section -->
            <section class="form-section">
                <div class="section-label">WRITE MESSAGE</div>
                <h2 class="section-title">ê¸€ ë‚¨ê¸°ê¸°</h2>
                <form id="guestbookForm" class="guestbook-form">
                    <div id="loginRequiredMessage" class="login-required-message" style="display: none;">
                        <p>ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤. ë¡œê·¸ì¸ í›„ ë°©ëª…ë¡ì„ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                        <button type="button" id="loginFromFormBtn" class="login-prompt-btn">ë¡œê·¸ì¸í•˜ê¸°</button>
                    </div>
                    <div class="form-row">
                        <div class="form-group form-group-name">
                            <label for="authorName">ì´ë¦„</label>
                            <input type="text" id="authorName" placeholder="ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”" required readonly>
                        </div>
                        <div class="form-group form-group-message">
                            <label for="message">í•˜ê³  ì‹¶ì€ ë§</label>
                            <div class="message-input-wrapper">
                                <textarea id="message" rows="3" placeholder="í•˜ê³  ì‹¶ì€ ë§ì„ ììœ ë¡­ê²Œ ì ì–´ì£¼ì„¸ìš”..." required></textarea>
                                <button type="submit" class="submit-btn">ì‘ì„±</button>
                            </div>
                        </div>
                    </div>
                </form>
            </section>

            <!-- Guestbook List Section -->
            <section class="list-section">
                <div class="section-label">GUESTBOOK</div>
                <h2 class="section-title">ì°½í˜„ì´í•œí…Œ ë‚¨ê¸´ ë§</h2>
                <div id="guestbookList" class="guestbook-list">
                    <!-- ë°©ëª…ë¡ í•­ëª©ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </div>
                <div id="emptyState" class="empty-state">
                    <p>ì•„ì§ ë°©ëª…ë¡ì´ ì—†ìŠµë‹ˆë‹¤.<br>ì²« ë²ˆì§¸ ë°©ëª…ë¡ì„ ë‚¨ê²¨ë³´ì„¸ìš”! âœ¨</p>
                </div>
            </section>
        </main>
    </div>

    <!-- Footer -->
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-info">
                <div class="footer-info-item">
                    <span class="footer-label">ì´ë¦„</span>
                    <span class="footer-value">ì´ì°½í˜„</span>
                </div>
                <div class="footer-info-item">
                    <span class="footer-label">ì´ë©”ì¼</span>
                    <span class="footer-value">changhyun@changhyun.com</span>
                </div>
                <div class="footer-info-item">
                    <span class="footer-label">ì „í™”ë²ˆí˜¸</span>
                    <span class="footer-value">010-9903-7949</span>
                </div>
            </div>
            <div class="footer-bottom">
                <p class="footer-copyright">Â© 2024 ì´ì°½í˜„. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js";
        import { getDatabase, ref, push, set, update, onValue, remove, orderByChild, query as rtdbQuery, get } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA40_T5wp_ADC1x_XXk7kqvSzkq07utfu4",
            authDomain: "talking-df564.firebaseapp.com",
            projectId: "talking-df564",
            storageBucket: "talking-df564.firebasestorage.app",
            messagingSenderId: "842436752280",
            appId: "1:842436752280:web:65ed5b871366b07d4a71ed",
            measurementId: "G-M1GNKNE8FR",
            databaseURL: "https://talking-df564-default-rtdb.firebaseio.com/"
        };

        // Initialize Firebase
        try {
            const app = initializeApp(firebaseConfig);
            const analytics = getAnalytics(app);
            const db = getDatabase(app);
            
            // Authentication ì´ˆê¸°í™” (ì—ëŸ¬ ì²˜ë¦¬ í¬í•¨)
            let auth;
            try {
                auth = getAuth(app);
                console.log('Firebase Authentication ì´ˆê¸°í™” ì„±ê³µ');
            } catch (authError) {
                console.error('Firebase Authentication ì´ˆê¸°í™” ì‹¤íŒ¨:', authError);
                alert('Firebase Authentication ì„¤ì • ì˜¤ë¥˜ì…ë‹ˆë‹¤.\n\nFirebase ì½˜ì†”ì—ì„œ Authenticationì„ í™œì„±í™”í•´ì£¼ì„¸ìš”:\n1. Firebase ì½˜ì†” ì ‘ì†\n2. Authentication ë©”ë‰´ í´ë¦­\n3. "ì‹œì‘í•˜ê¸°" ë²„íŠ¼ í´ë¦­\n4. "ì´ë©”ì¼/ë¹„ë°€ë²ˆí˜¸" ì¸ì¦ ë°©ë²• í™œì„±í™”');
                auth = null;
            }

            // Firebaseë¥¼ ì „ì—­ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •
            window.firebaseApp = app;
            window.firebaseDb = db;
            window.firebaseAuth = auth;
            window.firebaseFunctions = { ref, push, set, update, onValue, remove, orderByChild, rtdbQuery, get };
            window.authFunctions = { createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged };
            console.log('Firebase ì´ˆê¸°í™” ì™„ë£Œ (Database + Authentication)');
        } catch (error) {
            console.error('Firebase ì´ˆê¸°í™” ì‹¤íŒ¨:', error);
            alert('Firebase ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš”.');
        }
    </script>
    <script src="script.js"></script>
</body>
</html>
